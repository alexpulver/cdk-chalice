
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Welcome to cdk-chalice’s documentation! &#8212; cdk-chalice 0.9.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="canonical" href="https://cdk-chalice.softwhat.com/index.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="welcome-to-cdk-chalice-s-documentation">
<h1>Welcome to cdk-chalice’s documentation!<a class="headerlink" href="#welcome-to-cdk-chalice-s-documentation" title="Permalink to this headline">¶</a></h1>
<p>If you are looking for information on a specific class or method, this documentation is for you.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#chalice" id="id1">Chalice</a></p></li>
<li><p><a class="reference internal" href="#packageconfig" id="id2">PackageConfig</a></p></li>
<li><p><a class="reference internal" href="#usage-example" id="id3">Usage Example</a></p></li>
</ul>
</div>
<section id="chalice">
<h2><a class="toc-backref" href="#id1">Chalice</a><a class="headerlink" href="#chalice" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cdk_chalice.Chalice">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">cdk_chalice.</span></span><span class="sig-name descname"><span class="pre">Chalice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdk_chalice.html#Chalice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdk_chalice.Chalice" title="Permalink to this definition">¶</a></dt>
<dd><p>Chalice construct.</p>
<p>Adds the provided stage configuration to <a class="reference internal" href="#cdk_chalice.Chalice.source_dir" title="cdk_chalice.Chalice.source_dir"><code class="xref py py-attr docutils literal notranslate"><span class="pre">source_dir</span></code></a>/.chalice/config.json.
Stage name will be the string representation of current CDK <code class="docutils literal notranslate"><span class="pre">scope</span></code>.</p>
<p>Packages the application into AWS SAM format and imports the resulting template
into the construct tree under the provided <code class="docutils literal notranslate"><span class="pre">scope</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cdk_chalice.Chalice.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scope</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">aws_cdk.core.Construct</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">package_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#cdk_chalice.PackageConfig" title="cdk_chalice.PackageConfig"><span class="pre">cdk_chalice.PackageConfig</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_logical_ids</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cdk_chalice.html#Chalice.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdk_chalice.Chalice.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_dir</strong> (<em>str</em>) – Path to Chalice application source code.</p></li>
<li><p><strong>stage_config</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Chalice stage configuration.
The configuration object should have the same structure as Chalice JSON
stage configuration.</p></li>
<li><p><strong>package_config</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#cdk_chalice.PackageConfig" title="cdk_chalice.PackageConfig"><em>PackageConfig</em></a><em>]</em>) – Configuration for packaging
the Chalice application.</p></li>
<li><p><strong>preserve_logical_ids</strong> (<em>bool</em>) – Whether the resources should have the same
logical IDs in the resulting CDK template as they did in the original
CloudFormation template file. If you are vending a Construct using
cdk-chalice, make sure to pass this as <code class="docutils literal notranslate"><span class="pre">False</span></code>. Note: regardless of
whether this option is true or false, the <a class="reference internal" href="#cdk_chalice.Chalice.sam_template" title="cdk_chalice.Chalice.sam_template"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sam_template</span></code></a>’s
<code class="docutils literal notranslate"><span class="pre">get_resource</span></code> and related methods always uses the original logical ID
of the resource/element, as specified in the template file.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ChaliceError</strong> – Error packaging the Chalice application.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdk_chalice.Chalice.package_config">
<span class="sig-name descname"><span class="pre">package_config</span></span><a class="headerlink" href="#cdk_chalice.Chalice.package_config" title="Permalink to this definition">¶</a></dt>
<dd><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[PackageConfig]</span></code>) If not provided, <a class="reference internal" href="#cdk_chalice.PackageConfig" title="cdk_chalice.PackageConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">PackageConfig</span></code></a>
instance with default arguments is used.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdk_chalice.Chalice.sam_template">
<span class="sig-name descname"><span class="pre">sam_template</span></span><a class="headerlink" href="#cdk_chalice.Chalice.sam_template" title="Permalink to this definition">¶</a></dt>
<dd><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">aws_cdk.cloudformation_include.CfnInclude</span></code>) AWS SAM template
updated with AWS CDK values where applicable. Can be used to reference,
access, and customize resources generated by <cite>chalice package</cite> command
as CDK native objects.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdk_chalice.Chalice.source_dir">
<span class="sig-name descname"><span class="pre">source_dir</span></span><a class="headerlink" href="#cdk_chalice.Chalice.source_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) Path to Chalice application source code.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdk_chalice.Chalice.stage_config">
<span class="sig-name descname"><span class="pre">stage_config</span></span><a class="headerlink" href="#cdk_chalice.Chalice.stage_config" title="Permalink to this definition">¶</a></dt>
<dd><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">Any]</span></code>) Chalice stage configuration.
The object has the same structure as Chalice JSON stage configuration.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdk_chalice.Chalice.stage_name">
<span class="sig-name descname"><span class="pre">stage_name</span></span><a class="headerlink" href="#cdk_chalice.Chalice.stage_name" title="Permalink to this definition">¶</a></dt>
<dd><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) Chalice stage name.
It is automatically assigned the encompassing CDK <code class="docutils literal notranslate"><span class="pre">scope</span></code>’s name.</p>
</dd></dl>

</dd></dl>

</section>
<section id="packageconfig">
<h2><a class="toc-backref" href="#id2">PackageConfig</a><a class="headerlink" href="#packageconfig" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cdk_chalice.PackageConfig">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">cdk_chalice.</span></span><span class="sig-name descname"><span class="pre">PackageConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_container</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdk_chalice.html#PackageConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdk_chalice.PackageConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration for packaging Chalice app.</p>
<p>If your functions depend on packages that have natively compiled dependencies,
build your functions inside a Docker container. In order to instruct
<a class="reference internal" href="#cdk_chalice.Chalice" title="cdk_chalice.Chalice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chalice</span></code></a> class to do so, set <a class="reference internal" href="#cdk_chalice.PackageConfig.use_container" title="cdk_chalice.PackageConfig.use_container"><code class="xref py py-attr docutils literal notranslate"><span class="pre">use_container</span></code></a> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>When packaging the Chalice app in Docker container, the default image closely
mimics AWS Lambda execution environment. If a custom container image is used,
it is the owner responsibility to make sure it mimics Lambda execution environment.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cdk_chalice.PackageConfig.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_container</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/cdk_chalice.html#PackageConfig.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdk_chalice.PackageConfig.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_container</strong> (<em>bool</em>) – Package the Chalice app in Docker container.</p></li>
<li><p><strong>image</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Docker image name.
If image argument is not provided, the attribute is set to AWS Serverless
Application Model (AWS SAM) image from Amazon ECR Public. Current
environment’s Python version is used to select the image repository.
For example: <code class="docutils literal notranslate"><span class="pre">public.ecr.aws/sam/build-python3.7</span></code>.</p></li>
<li><p><strong>env</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>,</em><em>str</em><em>]</em><em>]</em>) – Environment variables to set for
packaging. <code class="docutils literal notranslate"><span class="pre">AWS_DEFAULT_REGION</span></code> is set to <code class="docutils literal notranslate"><span class="pre">us-east-1</span></code> unless
explicitly specified otherwise.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdk_chalice.PackageConfig.env">
<span class="sig-name descname"><span class="pre">env</span></span><a class="headerlink" href="#cdk_chalice.PackageConfig.env" title="Permalink to this definition">¶</a></dt>
<dd><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[Dict[str,</span> <span class="pre">str]]</span></code>) Environment variables used during
packaging.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdk_chalice.PackageConfig.image">
<span class="sig-name descname"><span class="pre">image</span></span><a class="headerlink" href="#cdk_chalice.PackageConfig.image" title="Permalink to this definition">¶</a></dt>
<dd><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[str]</span></code>) Docker image name. Used when <a class="reference internal" href="#cdk_chalice.PackageConfig.use_container" title="cdk_chalice.PackageConfig.use_container"><code class="xref py py-attr docutils literal notranslate"><span class="pre">use_container</span></code></a>
is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdk_chalice.PackageConfig.use_container">
<span class="sig-name descname"><span class="pre">use_container</span></span><a class="headerlink" href="#cdk_chalice.PackageConfig.use_container" title="Permalink to this definition">¶</a></dt>
<dd><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) If <code class="docutils literal notranslate"><span class="pre">True</span></code>, package the Chalice app in Docker container.
By default packages the app in subprocess.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-cdk_chalice"></span></section>
<section id="usage-example">
<h2><a class="toc-backref" href="#id3">Usage Example</a><a class="headerlink" href="#usage-example" title="Permalink to this headline">¶</a></h2>
<p>Example of using Chalice class in a stack that creates a basic web API.</p>
<p>Note the customization of Chalice-generated resources using <code class="docutils literal notranslate"><span class="pre">self.chalice.sam_template</span></code> attribute. <cite>cdk-chalice</cite> uses
<a class="reference external" href="https://docs.aws.amazon.com/cdk/api/latest/docs/cloudformation-include-readme.html">aws_cdk.cloudformation_include</a>
module to expose resources in the SAM template as native CDK objects. For example, <code class="docutils literal notranslate"><span class="pre">rest_api</span></code> variable below is an
instance of <code class="docutils literal notranslate"><span class="pre">aws_cdk.aws_sam.CfnApi</span></code> class. This capability allows to reference or customize Chalice application
resources within the broader CDK application.</p>
<p>The workflow for customization would be as follows:</p>
<ul class="simple">
<li><p>Implement the initial Chalice application using stage configuration (<code class="docutils literal notranslate"><span class="pre">stage_config</span></code>)</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">cdk</span> <span class="pre">synth</span></code></p></li>
<li><p>Open the generated <code class="docutils literal notranslate"><span class="pre">chalice.out/&lt;package</span> <span class="pre">ID&gt;/sam.json</span></code> file, and find the logical ID of the relevant resource</p></li>
<li><p>Retrieve the CDK object for the resource using <code class="docutils literal notranslate"><span class="pre">self.chalice.sam_template.get_resource('&lt;logical</span> <span class="pre">ID&gt;')</span></code> method</p></li>
</ul>
<p>Any modifications made to the resource will be reflected in the resulting CDK template.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">aws_cdk</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">aws_dynamodb</span> <span class="k">as</span> <span class="n">dynamodb</span><span class="p">,</span>
    <span class="n">aws_iam</span> <span class="k">as</span> <span class="n">iam</span><span class="p">,</span>
    <span class="n">core</span> <span class="k">as</span> <span class="n">cdk</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">cdk_chalice</span> <span class="kn">import</span> <span class="n">Chalice</span>


<span class="k">class</span> <span class="nc">WebApi</span><span class="p">(</span><span class="n">cdk</span><span class="o">.</span><span class="n">Stack</span><span class="p">):</span>

    <span class="n">_API_HANDLER_LAMBDA_MEMORY_SIZE</span> <span class="o">=</span> <span class="mi">128</span>
    <span class="n">_API_HANDLER_LAMBDA_TIMEOUT</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">cdk</span><span class="o">.</span><span class="n">Construct</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">partition_key</span> <span class="o">=</span> <span class="n">dynamodb</span><span class="o">.</span><span class="n">Attribute</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">dynamodb</span><span class="o">.</span><span class="n">AttributeType</span><span class="o">.</span><span class="n">STRING</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamodb_table</span> <span class="o">=</span> <span class="n">dynamodb</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;UsersTable&#39;</span><span class="p">,</span> <span class="n">partition_key</span><span class="o">=</span><span class="n">partition_key</span><span class="p">,</span>
                                             <span class="n">removal_policy</span><span class="o">=</span><span class="n">cdk</span><span class="o">.</span><span class="n">RemovalPolicy</span><span class="o">.</span><span class="n">DESTROY</span><span class="p">)</span>
        <span class="n">cdk</span><span class="o">.</span><span class="n">CfnOutput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;UsersTableName&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamodb_table</span><span class="o">.</span><span class="n">table_name</span><span class="p">)</span>

        <span class="n">lambda_service_principal</span> <span class="o">=</span> <span class="n">iam</span><span class="o">.</span><span class="n">ServicePrincipal</span><span class="p">(</span><span class="s1">&#39;lambda.amazonaws.com&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_handler_iam_role</span> <span class="o">=</span> <span class="n">iam</span><span class="o">.</span><span class="n">Role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ApiHandlerLambdaRole&#39;</span><span class="p">,</span> <span class="n">assumed_by</span><span class="o">=</span><span class="n">lambda_service_principal</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dynamodb_table</span><span class="o">.</span><span class="n">grant_read_write_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_handler_iam_role</span><span class="p">)</span>

        <span class="c1"># Assuming &#39;runtime&#39; is a relative directory in the same project/repository</span>
        <span class="n">runtime_source_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">,</span> <span class="s1">&#39;runtime&#39;</span><span class="p">)</span>
        <span class="n">chalice_stage_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_chalice_stage_config</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chalice</span> <span class="o">=</span> <span class="n">Chalice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;WebApi&#39;</span><span class="p">,</span> <span class="n">source_dir</span><span class="o">=</span><span class="n">runtime_source_dir</span><span class="p">,</span> <span class="n">stage_config</span><span class="o">=</span><span class="n">chalice_stage_config</span><span class="p">)</span>
        <span class="n">rest_api</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chalice</span><span class="o">.</span><span class="n">sam_template</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="s1">&#39;RestAPI&#39;</span><span class="p">)</span>
        <span class="n">rest_api</span><span class="o">.</span><span class="n">tracing_enabled</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_create_chalice_stage_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">chalice_stage_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;api_gateway_stage&#39;</span><span class="p">:</span> <span class="s1">&#39;v1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;lambda_functions&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;api_handler&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;manage_iam_role&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;iam_role_arn&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_handler_iam_role</span><span class="o">.</span><span class="n">role_arn</span><span class="p">,</span>
                    <span class="s1">&#39;environment_variables&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s1">&#39;DYNAMODB_TABLE_NAME&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamodb_table</span><span class="o">.</span><span class="n">table_name</span>
                    <span class="p">},</span>
                    <span class="s1">&#39;lambda_memory_size&#39;</span><span class="p">:</span> <span class="n">WebApi</span><span class="o">.</span><span class="n">_API_HANDLER_LAMBDA_MEMORY_SIZE</span><span class="p">,</span>
                    <span class="s1">&#39;lambda_timeout&#39;</span><span class="p">:</span> <span class="n">WebApi</span><span class="o">.</span><span class="n">_API_HANDLER_LAMBDA_TIMEOUT</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">chalice_stage_config</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">cdk-chalice</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=alexpulver&repo=cdk-chalice&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Alex Pulver.
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/alexpulver/cdk-chalice" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>